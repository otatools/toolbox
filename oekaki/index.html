<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>お絵かきクイズ - ポータル</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    <style>
        body { background: #0047AB; color: white; font-family: sans-serif; display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; flex-direction: column; }
        .box { background: rgba(255,255,255,0.2); padding: 40px; border-radius: 20px; width: 400px; text-align: center; border: 1px solid rgba(255,255,255,0.3); }
        .btn { width: 100%; padding: 18px; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; margin: 15px 0; font-size: 20px; text-decoration: none; display: block; box-sizing: border-box; }
        .btn-white { background: #fff; color: #0047AB; }
        .btn-gold { background: #ffcc00; color: #333; }
        .warning { margin-top: 20px; font-size: 14px; background: rgba(0,0,0,0.3); padding: 15px; border-radius: 10px; line-height: 1.6; text-align: left; }
        .footer { position: fixed; bottom: 5px; width: 100%; text-align: center; font-size: 12px; color: rgba(255,255,255,0.4); border-top: 1px solid rgba(255,255,255,0.1); padding-top: 5px; }
    </style>
</head>
<body>
    <div class="box">
        <h2 style="margin-top:0">お絵かきクイズ</h2>
        <button class="btn btn-white" onclick="location.href='answer.html'">クイズに参加する</button>
        
        <button class="btn btn-gold" onclick="createRoom()">新しい部屋を作成(先生用)</button>
        
        <div class="warning">
            【先生へ】<br>
            ・児童には「クイズに参加する」から入るよう伝えてください。<br>
            ・この画面をテレビに映す場合は、部屋番号に注意してください。
        </div>
    </div>
    <div class="footer">お絵かきクイズボード | Ver 10.2 | oekaki-quiz</div>

    <script>
        const config = {
            apiKey: "AIzaSyCo4uq1uJBRcgU-c7mWemukU25MrX635m0",
            authDomain: "oekaki-quiz-23ab5.firebaseapp.com",
            databaseURL: "https://oekaki-quiz-23ab5-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "oekaki-quiz-23ab5",
            appId: "1:61801325910:web:330fa68a1701dbbc9822f7"
        };
        firebase.initializeApp(config); const db = firebase.database();

        function createRoom() {
            const room = Math.floor(1000 + Math.random() * 9000);
            db.ref(`rooms/${room}`).set({ 
                active: false, 
                state: { 
                    currentDrawer: "",
                    correctAnswer: "",
                    multiplier: 1,
                    showHint: false,
                    countdown: 0,
                    active: false
                } 
            }).then(() => { 
                sessionStorage.setItem('quiz_room', room); 
                location.href = 'teacher.html'; 
            });
        }
    </script>
</body>
</html>